{
    "name": "firehose_frp_write_denied",
    "protocol": "firehose",
    "description": "Host attempts to write to 'config' partition on FRP-locked device; device returns NAK immediately.",
    "frp_context": {
        "status": "locked",
        "protected_partitions": [
            "config",
            "persist",
            "frp"
        ],
        "auth_required": true
    },
    "steps": [
        {
            "direction": "host_to_device",
            "label": "write_config_req",
            "data_hex": "3c3f786d6c2076657273696f6e3d22312e3022203f3e3c646174613e3c70726f6772616d20534543544f525f53495a455f494e5f42595445533d2235313222206e756d5f706172746974696f6e5f736563746f72733d22312220706879736963616c5f706172746974696f6e5f6e756d6265723d2230222073746172745f736563746f723d223022202f3e3c2f646174613e"
        },
        {
            "direction": "device_to_host",
            "label": "write_config_nak",
            "data_hex": "3c3f786d6c2076657273696f6e3d22312e3022203f3e3c646174613e3c726573706f6e73652076616c75653d224e414b2220726561736f6e3d2250726f74656374656420506172746974696f6e22202f3e3c2f646174613e"
        }
    ],
    "expectations": {
        "max_duration_ms": 2000,
        "engine_result": "AccessDenied",
        "protected_operation": "write_partition"
    }
}